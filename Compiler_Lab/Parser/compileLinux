#!/bin/bash
clear
file_name="c.system"
input_file_name="input.txt"
clean(){
	echo -e "\n------------------------------------" 
	echo    ":::: Clean ::::" 
	echo -e "------------------------------------\n" 
	#rm -rf scannerRule.yy.obj;
	#rm -rf AST.obj;
	#rm -rf parserRule.tab.obj;
	echo -e "------------------------------------\n" 
}

compile(){
	echo -e "\n------------------------------------" 
	echo 	":::: Compile ::::" 
	echo -e "------------------------------------\n" 

	flex -d --nounistd -oscannerRule.yy.cpp scannerRule.l
	bison -d -oparserRule.tab.cpp parserRule.y

	g++ -c scannerRule.yy.cpp -o scannerRule.yy.obj
	g++ -c AST.cpp -o AST.obj
	g++ -c parserRule.tab.cpp -o parserRule.tab.obj
	g++ -o $file_name compiler.cpp parserRule.tab.obj scannerRule.yy.obj AST.obj
	echo -e "------------------------------------\n" 
}

run(){
	echo -e "\n------------------------------------" 
	echo 	":::: RUN ::::"
	echo -e "file : "$file_name 
	echo -e "input file : "$input_file_name 
	echo -e "------------------------------------\n" 
	echo "/****** Start RUN ******/"

	./$file_name $input_file_name #AddressBookTest1.txt

	echo "/****** End RUN ******/"
	echo -e "------------------------------------\n" 
	
}

while [ $# -gt 0 ]
do
    case "$1" in
    	-o)  
			file_name=$2; shift ;;
		-i)  
			input_file_name=$2; shift ;;
        clean)  
			clean ;;
        compile)  
			compile;;
        run)  
			run;;
 		*)  
	      echo "`basename ${0}`:usage: [-o file name] | [clean] | [compile] | [run]"
	      exit 1 # Command to come out of the program with status 1
	      ;; 
    esac
    shift
done



